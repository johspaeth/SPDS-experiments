<?xml version="1.0" encoding="ASCII"?>
<typestateRule>
	<automaton name="automaton_1">
		<state name="uninitialized" initial="true" />
		<state name="initialized" />
		<state name="err" accepting="true" />

		<event type="IDispatchEvent" name="load">
			<pattern pattern=".*load\(.*" />
		</event>
		<event type="IDispatchEvent" name="is_Methods">
			<pattern pattern="java.security.KeyStore.is.*\(.*" />
		</event>
		<event type="IDispatchEvent" name="s_Methods">
			<pattern pattern="java.security.KeyStore.s.*\(.*" />
		</event>
		<event type="IDispatchEvent" name="getC_Methods">
			<pattern pattern="java.security.KeyStore.getC.*\(.*" />
		</event>
		<event type="IDispatchEvent" name="getKey">
			<pattern pattern="java.security.KeyStore.getKey\(.*" />
		</event>
		<event type="IDispatchEvent" name="aliases">
			<pattern pattern=".*aliases\(.*" />
		</event>
		<event type="IDispatchEvent" name="containsAlias">
			<pattern pattern=".*containsAlias\(.*" />
		</event>
		<event type="IDispatchEvent" name="deleteEntry">
			<pattern pattern=".*deleteEntry\(.*" />
		</event>

		<transition source="uninitialized" event="load"
			destination="initialized" />
		<transition source="uninitialized" event="is_Methods"
			destination="err" />
		<transition source="uninitialized" event="s_Methods"
			destination="err" />
		<transition source="uninitialized" event="getC_Methods"
			destination="err" />
		<transition source="uninitialized" event="getKey"
			destination="err" />
		<transition source="uninitialized" event="aliases"
			destination="err" />
		<transition source="uninitialized" event="containsAlias"
			destination="err" />
		<transition source="uninitialized" event="deleteEntry"
			destination="err" />

		<transition source="initialized" event="load"
			destination="initialized" />
		<transition source="initialized" event="is_Methods"
			destination="initialized" />
		<transition source="initialized" event="s_Methods"
			destination="initialized" />
		<transition source="initialized" event="getC_Methods"
			destination="initialized" />
		<transition source="initialized" event="getKey"
			destination="initialized" />
		<transition source="initialized" event="aliases"
			destination="initialized" />
		<transition source="initialized" event="containsAlias"
			destination="initialized" />
		<transition source="initialized" event="deleteEntry"
			destination="initialized" />

		<transition source="err" event="load" destination="err" />
		<transition source="err" event="is_Methods" destination="err" />
		<transition source="err" event="s_Methods" destination="err" />
		<transition source="err" event="getC_Methods"
			destination="err" />
		<transition source="err" event="getKey" destination="err" />
		<transition source="err" event="aliases" destination="err" />
		<transition source="err" event="containsAlias"
			destination="err" />
		<transition source="err" event="deleteEntry" destination="err" />
	</automaton>

	<attributes name="Always initialize java.security.KeyStore before using it"
		severity="Warning" category="Correctness" level="MethodLevel"
		typeStateAutomaton="automaton_1" />
	<type name="Ljava/security/KeyStore" />

</typestateRule>  
